<html lang="en">
<head>
    <meta charset="UTF-8">

    <!-- Title: -->
    <title>Terrorist Attacks in Europe</title>

    <!-- Import CSS style -->
    <link rel="stylesheet" href="structure.css">

    <!-- Shortcut icon in browser tab -->
    <link rel="shortcut icon" href="terrorist-thug.ico"/>

    <!--Font-->
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">

    <!-- Leaflet CSS and Javascript file -->
    <!-- Check out http://leafletjs.com/examples/quick-start/ for an introduction on using leaflet: -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"
          integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="
          crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"
            integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log=="
            crossorigin=""></script>

    <!-- D3 & JS & JQUERY-->
    <script src="https://d3js.org/d3.v4.min.js"></script>

    <script src="map.js"></script>
    <script src="filter.js"></script>


    <!-- Slider -->
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="slider.js"></script>

    <!-- Map plot -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.css">
    <script src="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.js"></script>

    <!-- JS -->
    <script>
        d3.select(window).on('load', init);

        // Global: data, map
        var DATA;
        var FILTER =
            {success: "all",
             attacktype: "all",
             target: "all",
             lowerdate: new Date('2013.01.01'),
             upperdate: new Date('2017.01.01')
            };
        var MAP;
        var SVG;

        // Use custom colours:
        var cat_col_dic = {1:"#41ab5d",2:"#fec44f",3:"#f03b20",4:"#df65b0",5:"#0570b0",
            6: "#9e9ac8", 7: "#08306b",8:"#54278f",9:"#238443"};


        function init() {
            d3.csv("data/gtd_europe.csv", function (mydata) {
                mydata.forEach(function (d) {
                    // the + sign converts numeric string to number:
                    d.eventid = +d.eventid -1;
                    //d.iyear = +d.iyear;
                    //d.imonth = +d.imonth;
                    //d.iday = +d.iday;
                    // location
                    d.latitude = +d.latitude;
                    d.longitude = +d.longitude;
                    d.LatLng = new L.LatLng(d.latitude, d.longitude);
                    // filter criteria
                    d.success = +d.success;
                    d.attacktype = +d.attacktype1;
                    d.attacktype_txt = d.attacktype1_txt;
                    d.target = +d.targtype1;
                    // other
                    d.nkill = +d.nkill;
                    d.nkillter = +d.nkillter;
                    d.date = d.iyear + "/" + d.imonth + "/" + d.iday;
                    // perpetrator:
                    d.terrorist = d.gname;

                DATA = mydata;


                // Callback
                drawMap();
                drawPoints();
            });
        }
        
    </script>
</head>

<body>

<!-- Container (containing the whole visualisation) -->
<div id="container">

    <!-- TITLE: -->
    <div id="headline"><h1>Terror in Europe</h1></div>

    <!-- FILTERS: -->
    <div id="filters">
        <h3>Filter</h3>
        <label for="success_filter">Attack succeeded:</label>
        <select id="success_filter" onchange="FILTER.success = this.value; drawPoints();">
            <option value="all" selected>All</option>
            <option value="1">Yes</option>
            <option value="0">No</option>
        </select>
        <br>
        <label for="attacktype_filter">Attack type:</label>
        <!-- Attention: numbering in attacktype and numbering in filter for attacktype_txt as in codebook: -->
        <select id="attacktype_filter" onchange="FILTER.attacktype = this.value; drawPoints();">
            <option value="all" selected>All</option>
            <option value="1">Assassination</option>
            <option value="2">Armed Assault</option>
            <option value="3">Bombing/Explosion</option>
            <option value="4">Hijacking</option>
            <option value="5">Hostage Taking (Barricade Incident) </option>
            <option value="6">Hostage Taking (Kidnapping) </option>
            <option value="7">Facility/Infrastructure Attack</option>
            <option value="8">Unarmed Assault</option>
            <option value="9">Unknown</option>
        </select>
        <br>
        <!-- TARGET FILTER -->
        <label for="target_filter">Target/Victim:</label>
        <select id="target_filter" onchange="FILTER.target = this.value; drawPoints();">
            <option value="all" selected>All</option>
            <option value="1">Anarchists</option>
            <option value="2">Government (general)</option>
            <option value="3">Police</option>
            <option value="4">Military</option>
            <option value="5">Abortion related</option>
            <option value="6">Airports & Aircraft</option>
            <option value="7">Government (diplomatic)</option>
            <option value="8">Educational institution</option>
            <option value="9">Food or water supply</option>
            <option value="10">Journalists & Media</option>
            <option value="11">Maritime (includes ports and maritime facilities)</option>
            <option value="12">NGO</option>
            <option value="13">Other</option>
            <option value="14">Private citizens & property</option>
            <option value="15">Religious figures/institutions</option>
            <option value="16">Telecommunication</option>
            <option value="17">Terrorists/Non-state militias</option>
            <option value="18">Tourists</option>
            <option value="19">Transportation (other than aviation)</option>
            <option value="20">Unknown</option>
            <option value="21">Utilities</option>
            <option value="22">Violent political parties</option>
        </select>

        <!-- TERRORIST FILTER -->
        <label for="target_filter">Perpetrator:</label>
        <select id="target_filter" onchange="FILTER.terrorist = this.value; drawPoints();">
            <option value="all" selected>All</option>
            <option value="1">Anarchists</option>
            <option value="2">Anti-Immigrant extremists</option>
            <option value="3">Anti-Muslim extremists</option>
            <option value="4">Caucasus Emirate</option>
            <option value="6">Caucasus Province of the Islamic State</option>
            <option value="7">Conspiracy of Cells of Fire</option>
            <option value="8">Cossack Separatists</option>
            <option value="9">Dissident Republicans</option>
            <option value="10">Donetsk People's Republic</option>
            <option value="11">Informal Anarchist Federation</option>
            <option value="12">Islamic State of Iraq and the Levant (ISIL)</option>
            <option value="13">Jihadi-inspired extremists</option>
            <option value="14">Kurdistan Workers' Party (PKK)</option>
            <option value="15">Loyalists</option>
            <option value="16">Luhansk People's Republic</option>
            <option value="17">Muslim extremists</option>
            <option value="18">Neo-Nazi extremists</option>
            <option value="19">Oglaigh na hEireann</option>
            <option value="20">Pro-Russia Militia</option>
            <option value="21">Right Sector</option>
            <option value="22">Right-wing extremists</option>
            <option value="23">The New Irish Republican Army</option>
            <option value="24">Ukrainian nationalists</option>
            <option value="25">Unknown</option>
        </select>
    </div>

    <!-- INFOBOX: -->
    <div id="infobox">
        <h3>Infobox</h3>
    </div>

    <!-- MAP: -->
    <div id="mapid" height="180px"></div>

    <!-- TIME SLIDER: -->
    <div id="slider">
        <h3 style = "margin-right: 0; margin-bottom:0;margin-left:3%;float:left;">Time</h3>
        <div id="slider-range" style = "margin-top:1.8%; margin-left:10%;margin-right:7%;"></div>
        <div id ="min"></div>
        <div id = "max"></div>
    </div>
    
    <!-- LEGEND: -->
    <div id="legend">
      <input id="toggle" type="checkbox" unchecked>
      <label for="toggle" id="legend_lab">Legend</label>
      <div id="expand">
        <section>
            <div style="background-color:#41ab5d;" class = "bullets">&nbsp;</div>&nbsp;Assassination<br>
            <div style="background-color:#fec44f;" class = "bullets">&nbsp;</div>&nbsp;Armed Assault<br>
            <div style="background-color:#f03b20;" class = "bullets">&nbsp;</div>&nbsp;Bombing/Explosion<br>
            <div style="background-color:#df65b0;" class = "bullets">&nbsp;</div>&nbsp;Hijacking<br>
            <div style="background-color:#0570b0;" class = "bullets">&nbsp;</div>&nbsp;Hostage Taking (Barricade Incident)<br>
            <div style="background-color:#9e9ac8;" class = "bullets">&nbsp;</div>&nbsp;Hostage Taking (Kidnapping)<br>
            <div style="background-color:#08306b;" class = "bullets">&nbsp;</div>&nbsp;Facility/Infrastructure Attack<br>
            <div style="background-color:#54278f;" class = "bullets">&nbsp;</div>&nbsp;Unarmed Assault<br>
            <div style="background-color:#238443;" class = "bullets">&nbsp;</div>&nbsp;Unknown<br>
 
        </section>
      </div>
    </div>
</div>

</body>

</html>
